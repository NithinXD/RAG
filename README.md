# Red Trends Spa & Wellness Center AI Agent

This project implements an AI chatbot agent for Red Trends Spa & Wellness Center using Agno and Gemini. The agent provides customer support, answers questions about services, and handles bookings.

## Features

- **Service Information**: Provides details about spa services, pricing, and descriptions
- **Booking Management**: Allows users to book appointments and manages the booking process
- **Context Retention**: Remembers previous conversations and user preferences
- **Vector Memory**: Stores conversations and FAQs in Pinecone for semantic search
- **Web Search**: Uses Serper API to search the web for information not in the database

## Architecture

The system consists of the following components:

1. **Spa Agent (`spa_agent.py`)**: Core AI agent implementation using Agno and Gemini
2. **API Server (`api.py`)**: Flask server that exposes the agent via REST API
3. **Web Interface (`static/index.html`)**: Simple HTML/CSS/JS interface for interacting with the agent

## Setup

### Prerequisites

- Python 3.8+
- PostgreSQL database with the following schema:
  ```sql
  create table public.services (
    "Service ID" bigint generated by default as identity not null,
    "Service Name" text not null,
    "Description" text null,
    "Price (INR)" double precision null,
    "Category" text null,
    constraint services_pkey primary key ("Service ID")
  ) TABLESPACE pg_default;

  create table public.bookings (
    "Booking ID" bigint generated by default as identity not null,
    "Customer Name" text not null,
    "Service ID" bigint not null,
    "Booking Date" date null,
    "Time Slot (HH:MM)" time without time zone null,
    "Price (INR)" double precision null,
    constraint bookings_pkey primary key ("Booking ID"),
    constraint bookings_Service ID_fkey foreign KEY ("Service ID") references services ("Service ID")
  ) TABLESPACE pg_default;
  ```
- Pinecone account for vector storage
- Gemini API key
- Serper API key

### Environment Variables

Create a `.env` file with the following variables:

```
# Database credentials
user=your_db_user
password=your_db_password
host=your_db_host
port=your_db_port
dbname=your_db_name

# API keys
GEMINI_API_KEY=your_gemini_api_key
SERPER_API_KEY=your_serper_api_key

# Pinecone
PINECONE_API_KEY=your_pinecone_api_key
PINECONE_ENVIRONMENT=your_pinecone_environment
PINECONE_INDEX=your_pinecone_index
```

### Installation

1. Clone the repository
2. Install dependencies:
   ```
   pip install -r requirements.txt
   ```
3. Run the API server:
   ```
   python api.py
   ```
4. Access the web interface at `http://localhost:5000`

## Usage

### API Endpoints

- **POST /api/chat**: Process a chat message
  ```json
  {
    "user_id": "unique_user_id",
    "message": "User message here"
  }
  ```

- **GET /api/booking?user_id=unique_user_id**: Get current booking information

- **POST /api/booking/clear**: Clear booking information
  ```json
  {
    "user_id": "unique_user_id"
  }
  ```

- **GET /api/history?user_id=unique_user_id&limit=10**: Get conversation history

### Web Interface

The web interface provides a simple chat interface for interacting with the agent. It also displays current booking information and allows users to clear their booking or start a new session.

## Implementation Details

### Vector Memory

The system uses Pinecone to store and retrieve:
- Conversation history
- Frequently asked questions (FAQs)
- User preferences
- Service interests
- Booking information

### Agno Agent

The Agno agent is configured with:
- Gemini 1.5 Pro model
- SQL tools for database access
- Web search tools for external information

### Key Management

The system implements API key rotation to handle rate limits and errors:
- Multiple Gemini API keys can be configured
- Keys are automatically rotated when errors occur
- The system falls back to alternative keys when needed

## License

This project is licensed under the MIT License - see the LICENSE file for details.